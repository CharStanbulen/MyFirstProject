/*grunt_test-1.0.0.js 2016-01-21*/
$(function(){var a=Backbone.Model.extend({validate:function(a){for(var b in a){if(""==a[b])return b+"不能为空";if("Score"==b&&isNaN(a.Score))return"分数必须是数字"}}}),b=Backbone.Collection.extend({model:a}),c=new b,d=Backbone.View.extend({tagName:"li",className:"li_c",template:_.template($("#item-template").html()),events:{"dblclick span":"editing","blur input,select":"blur","click span a":"dele"},editing:function(a){$(a.currentTarget).removeClass("show").addClass("editing").find("input,select").focus()},blur:function(a){var b=$(a.currentTarget),c={};c[b.attr("name")]=b.val(),this.model.set(c,{validate:!0}),$(a.currentTarget).parent().parent().removeClass("editing").addClass("show")},dele:function(){this.model.destroy()},initialize:function(){this.model.on("change",this.render,this),this.model.on("destroy",this.remove,this)},render:function(){return $(this.el).html(this.template(this.model.toJSON())),this.setValue(),this},remove:function(){$(this.el).remove()},setValue:function(){var a=this.model;$(this.el).find("input,select").each(function(){var b=$(this);b.val(a.get(b.attr("name")))})}}),e=Backbone.View.extend({el:$("#stuManager"),events:{"click #btnAdd":"newstu"},initialize:function(){c.bind("add",this.addData,this),$("#StuID").val(c.length+1)},newstu:function(b){var d=new a,e={};$("#Name,#Sex,#Score").each(function(){e[$(this).attr("name")]=$(this).val()}),d.bind("invalid",function(a,b){$("#pStatus").show().html(b)}),d.set(e,{validate:!0})&&(c.add(d),$("#pStatus").hide())},addData:function(a){a.set({StuID:a.get("StuID")||c.length});var b=new d({model:a});$("#ulMessage").append(b.render().el),$("#Name,#Score").each(function(){$(this).val("")}),$("#StuID").val(c.length+1)}}),e=new e});